# 批量导入模板使用说明

## 📋 模板字段说明

### 必需字段（3个）

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `Source_ID` | 来源机构ID（整数）| `1`（必须在SOURCES表中存在）|
| `Original_ID` | 原始编号 | `EXAMPLE-001` |
| `Title_CN` | 中文标题 | `示例文物` |

### 可选字段（19个）

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `Title_EN` | 英文标题 | `Example Artifact` |
| `Description_CN` | 中文描述 | `这是一个示例描述` |
| `Classification` | 分类 | `青铜器` |
| `Material` | 材质 | `青铜` |
| `Date_CN` | 中文年代 | `商代晚期` |
| `Date_EN` | 英文年代 | `Late Shang Dynasty` |
| `Start_Year` | 起始年份（整数，负数表示公元前） | `-1300` |
| `End_Year` | 结束年份（整数） | `-1046` |
| `Geography` | 地理 | `河南安阳` |
| `Culture` | 文化 | `商文化` |
| `Artist` | 艺术家 | `佚名` |
| `Credit_Line` | 版权说明 | `某博物馆藏` |
| `Page_Link` | 页面链接 | `https://example.com` |
| `Size_Type` | 尺寸类型 | `高`、`宽`、`直径` |
| `Size_Value` | 尺寸数值（小数） | `25.5` |
| `Size_Unit` | 尺寸单位 | `cm`、`mm`、`in` |
| `Image_Link` | 图像网络链接 | `https://example.com/image.jpg` |
| `Local_Path` | 本地图像路径（相对于static目录） | `images/met_images/example.jpg` |
| `Version_Type` | 图像版本类型 | `Original`（默认值） |

---

## 📥 下载模板

1. 登录后台管理：`http://localhost:5000/admin/login`
2. 访问导入页面：`http://localhost:5000/admin/import`
3. 点击"下载模板"按钮
4. 保存CSV文件到本地

---

## ✏️ 填写模板

### 步骤1：准备Source_ID

首先确认要使用的Source_ID：

```sql
SELECT Source_ID, Museum_Code, Museum_Name_CN FROM SOURCES;
```

常见值：
- MET（大都会艺术博物馆）：通常是 `1` 或 `2`
- NPM（国立故宫博物院）：通常是 `2` 或 `3`

如果不确定，可以查询：
```sql
SELECT Source_ID FROM SOURCES WHERE Museum_Code = 'MET';
```

### 步骤2：填写必需字段

- **Source_ID**：填写查询到的来源机构ID（整数）
- **Original_ID**：填写文物的原始编号（唯一标识）
- **Title_CN**：填写中文标题

### 步骤3：填写可选字段

根据需要填写其他字段。空字段可以留空，系统会自动处理。

**注意事项：**
- 数值字段（Source_ID, Start_Year, End_Year, Size_Value）必须填写数字
- 日期字段（Start_Year, End_Year）中，公元前使用负数，如 `-1300` 表示公元前1300年
- Local_Path 是相对于 `static/` 目录的路径，如 `images/met_images/123.jpg`

---

## 🔍 常见问题

### Q1: Source_ID应该填什么？

**A:** Source_ID是来源机构在数据库中的ID。可以通过以下SQL查询：

```sql
-- 查看所有来源机构
SELECT * FROM SOURCES;

-- 查找特定机构的ID
SELECT Source_ID FROM SOURCES WHERE Museum_Code = 'MET';  -- 大都会
SELECT Source_ID FROM SOURCES WHERE Museum_Code = 'NPM';  -- 故宫
```

### Q2: 如果Source_ID不存在怎么办？

**A:** 需要在导入前先在SOURCES表中创建来源机构记录：

```sql
INSERT INTO SOURCES (Museum_Code, Museum_Name_CN) 
VALUES ('YOUR_CODE', '您的博物馆名称');
```

然后使用返回的Source_ID。

### Q3: Local_Path应该怎么填？

**A:** Local_Path是图像文件的相对路径（相对于项目的static目录）：

- 大都会图像：`images/met_images/123456.jpg`
- NPM图像：`images/palace_images/故宫文物001.jpg`
- 其他图像：`images/other_folder/filename.jpg`

**重要：** 文件必须已经存在于对应的目录中。

### Q4: 可以只填写必需字段吗？

**A:** 可以。只需要填写 `Source_ID`、`Original_ID`、`Title_CN` 三个必需字段即可。其他字段可以留空。

### Q5: 导入时提示"Not enough parameters"错误？

**A:** 这通常是因为：
1. CSV列名不正确（应使用英文列名）
2. 必需字段为空
3. 数值字段格式错误

**解决方案：**
- 使用后台提供的标准模板
- 检查所有必需字段是否填写
- 确保数值字段填写的是数字，不是文本

---

## 📝 模板示例

```csv
Source_ID,Original_ID,Title_CN,Title_EN,Description_CN,Classification,Material,Date_CN,Date_EN,Start_Year,End_Year,Geography,Culture,Artist,Credit_Line,Page_Link,Size_Type,Size_Value,Size_Unit,Image_Link,Local_Path,Version_Type
1,EXAMPLE-001,示例文物,Example Artifact,这是一个示例描述,青铜器,青铜,商代晚期,Late Shang Dynasty,-1300,-1046,河南安阳,商文化,佚名,某博物馆藏,https://example.com,高,25.5,cm,https://example.com/image.jpg,images/met_images/example.jpg,Original
```

---

## ✅ 验证清单

导入前请检查：

- [ ] Source_ID已确认存在
- [ ] Original_ID已填写（唯一标识）
- [ ] Title_CN已填写（中文标题）
- [ ] 数值字段（Source_ID, Start_Year, End_Year, Size_Value）格式正确
- [ ] 图像文件（如果填写了Local_Path）已存在于对应目录
- [ ] CSV文件使用UTF-8编码保存（或使用后台下载的模板）

---

## 🚀 导入步骤

1. **下载模板**：从后台导入页面下载标准模板
2. **填写数据**：按照上述说明填写数据
3. **保存文件**：保存为CSV格式（UTF-8编码）
4. **上传导入**：
   - 选择文件
   - 选择导入模式（跳过/更新）
   - 点击"开始导入"
5. **查看结果**：
   - 查看导入统计
   - 如有失败，查看系统操作日志

---

## 📊 导入模式说明

### 跳过模式（skip）

- 如果记录已存在（根据Source_ID + Original_ID判断），则跳过该记录
- 不会更新已有数据
- 只导入新记录

### 更新模式（update）

- 如果记录已存在，用新数据覆盖旧数据
- 如果记录不存在，创建新记录
- **注意：** 更新模式会覆盖现有数据，请谨慎使用

---

## 🔗 相关文档

- `批量导入功能说明.md` - 详细功能说明
- `安装说明.md` - 安装和验证步骤

