# NPMåšç‰©é¦†ï¼ˆå›½ç«‹æ•…å®«åšç‰©é™¢ï¼‰å›¾åƒå­˜å‚¨è¯´æ˜

## ğŸ“ å­˜å‚¨ç›®å½•

**NPMåšç‰©é¦†çš„å›¾åƒåº”è¯¥å­˜å‚¨åœ¨ï¼š**
```
static/images/palace_images/
```

**å®Œæ•´è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š**
```
d:\a_schoolworks\25-26autumn\project0\flask0\static\images\palace_images\
```

---

## ğŸ” å›¾åƒè·¯å¾„è‡ªåŠ¨åˆ†é…è§„åˆ™

ç³»ç»Ÿä½¿ç”¨ `normalize_image_path()` å‡½æ•°æ ¹æ®**æ–‡ä»¶åç‰¹å¾**è‡ªåŠ¨åˆ†é…å›¾åƒåˆ°ç›¸åº”ç›®å½•ï¼š

### åˆ†é…è§„åˆ™

```276:301:app.py
def normalize_image_path(path):
    if not path:
        return None

    # 1. çµ±ä¸€æ–œç·šä¸¦è½‰å­—ä¸²
    p = str(path).strip().replace('\\', '/')
    
    # 2. å–å¾—ç´”æª”å (ä¸è«–è·¯å¾‘å¤šäº‚ï¼Œåªæ‹¿æœ€å¾Œé‚£æ®µ xxx.jpg)
    filename = p.split('/')[-1]

    # 3. æ ¹æ“šæª”æ¡ˆåç¨±ç‰¹å¾µï¼Œåˆ†é…åˆ°æ­£ç¢ºçš„è³‡æ–™å¤¾
    # æ•…å®®åœ–ç‰‡ç‰¹å¾µï¼šåŒ…å« 'æ•…' æˆ– 'è³¼'
    if any(k in filename for k in ['æ•…', 'è³¼']):
        # å¼·åˆ¶æŒ‡å‘ static/images/palace_images/ 
        return f"images/palace_images/{filename}"
    
    # å¤§éƒ½æœƒåœ–ç‰‡ç‰¹å¾µï¼šç´”æ•¸å­—
    elif filename.replace('.jpg', '').replace('.png', '').isdigit():
        # å¼·åˆ¶æŒ‡å‘ static/images/met_images/
        return f"images/met_images/{filename}"
    
    # å…¶ä»–æƒ…æ³ (å¦‚æœè·¯å¾‘å·²ç¶“æ˜¯ images/é–‹é ­ä¸”æ­£ç¢º)
    if 'images/' in p:
        return p.split('static/')[-1].lstrip('/')
        
    return f"images/{filename}"
```

### ç›®å½•åˆ†é…è¡¨

| æ–‡ä»¶åç‰¹å¾ | å­˜å‚¨ç›®å½• | ç¤ºä¾‹ |
|-----------|---------|------|
| åŒ…å« `æ•…` æˆ– `è³¼` å­—ç¬¦ | `static/images/palace_images/` | `æ•…123.jpg`, `è³¼456.png` |
| çº¯æ•°å­—æ–‡ä»¶å | `static/images/met_images/` | `192693.jpg`, `435809.jpg` |
| å…¶ä»–æƒ…å†µ | `static/images/` | `other_image.jpg` |

---

## ğŸ“ ä½¿ç”¨æ­¥éª¤

### 1. åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š

```powershell
# åˆ›å»º palace_images ç›®å½•
mkdir static\images\palace_images
```

æˆ–æ‰‹åŠ¨åˆ›å»ºï¼š`static/images/palace_images/` æ–‡ä»¶å¤¹

### 2. å­˜å‚¨å›¾åƒæ–‡ä»¶

å°†NPMåšç‰©é¦†çš„å›¾åƒæ–‡ä»¶å¤åˆ¶åˆ°ï¼š
```
static/images/palace_images/
```

**æ–‡ä»¶å‘½åå»ºè®®ï¼š**
- æ–‡ä»¶ååº”åŒ…å« `æ•…` æˆ– `è³¼` å­—ç¬¦ï¼Œä»¥ä¾¿ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«
- ä¾‹å¦‚ï¼š`æ•…å®®æ–‡ç‰©001.jpg`, `è³¼è—123.jpg`, `NPM_æ•…å®®456.png`

### 3. åœ¨Excelä¸­å¡«å†™è·¯å¾„

åœ¨å¯¼å…¥Excelçš„ `æœ¬åœ°å›¾ç‰‡è·¯å¾„` åˆ—ä¸­ï¼Œæ‚¨å¯ä»¥å¡«å†™ï¼š

**æ–¹å¼ä¸€ï¼šåªå†™æ–‡ä»¶åï¼ˆæ¨èï¼‰**
```
æ•…å®®æ–‡ç‰©001.jpg
```
ç³»ç»Ÿä¼šè‡ªåŠ¨è½¬æ¢ä¸ºï¼š`images/palace_images/æ•…å®®æ–‡ç‰©001.jpg`

**æ–¹å¼äºŒï¼šç›¸å¯¹è·¯å¾„**
```
images/palace_images/æ•…å®®æ–‡ç‰©001.jpg
```
ç³»ç»Ÿä¼šä¿æŒè¿™ä¸ªè·¯å¾„

**æ–¹å¼ä¸‰ï¼šå®Œæ•´è·¯å¾„ï¼ˆä¼šè¢«å¤„ç†ï¼‰**
```
D:\path\to\static\images\palace_images\æ•…å®®æ–‡ç‰©001.jpg
```
ç³»ç»Ÿä¼šæå–æ–‡ä»¶åå¹¶é‡æ–°åˆ†é…åˆ°æ­£ç¡®ç›®å½•

---

## ğŸ—‚ï¸ å½“å‰é¡¹ç›®å›¾åƒç›®å½•ç»“æ„

```
static/
â””â”€â”€ images/
    â”œâ”€â”€ chinese.png          # UIå›¾ç‰‡
    â”œâ”€â”€ logo.png            # Logo
    â”œâ”€â”€ western.png         # UIå›¾ç‰‡
    â”œâ”€â”€ met_images/         # å¤§éƒ½ä¼šåšç‰©é¦†å›¾åƒï¼ˆå·²å­˜åœ¨ï¼‰
    â”‚   â”œâ”€â”€ 192693.jpg
    â”‚   â”œâ”€â”€ 192770.jpg
    â”‚   â””â”€â”€ ...
    â””â”€â”€ palace_images/      # NPMåšç‰©é¦†å›¾åƒï¼ˆéœ€åˆ›å»ºï¼‰
        â””â”€â”€ (æ‚¨çš„NPMå›¾åƒæ–‡ä»¶)
```

---

## âš™ï¸ æ•°æ®åº“å­˜å‚¨

å›¾åƒè·¯å¾„å­˜å‚¨åœ¨ `IMAGE_VERSIONS` è¡¨çš„ `Local_Path` å­—æ®µä¸­ã€‚

å¯¼å…¥è„šæœ¬ (`database_npm/data_importer_multi_table.py`) ä¼šï¼š
1. è¯»å–Excelä¸­çš„ `local_path` åˆ—
2. ç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“çš„ `Local_Path` å­—æ®µ
3. åœ¨æ˜¾ç¤ºæ—¶ï¼Œé€šè¿‡ `normalize_image_path()` å‡½æ•°è§„èŒƒåŒ–è·¯å¾„

---

## âœ… éªŒè¯æ–¹æ³•

### æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨

```powershell
Test-Path static\images\palace_images
```

### æ£€æŸ¥å›¾åƒæ–‡ä»¶

```powershell
Get-ChildItem static\images\palace_images
```

### åœ¨æµè§ˆå™¨ä¸­è®¿é—®

å›¾åƒä¸Šä¼ åï¼Œåœ¨æµè§ˆå™¨ä¸­å¯ä»¥é€šè¿‡ä»¥ä¸‹URLè®¿é—®ï¼š
```
http://localhost:5000/static/images/palace_images/æ–‡ä»¶å.jpg
```

---

## ğŸ”„ å¦‚æœæ–‡ä»¶åä¸ç¬¦åˆç‰¹å¾

å¦‚æœæ‚¨çš„NPMå›¾åƒæ–‡ä»¶åä¸åŒ…å« `æ•…` æˆ– `è³¼` å­—ç¬¦ï¼Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š

### æ–¹å¼ä¸€ï¼šé‡å‘½åæ–‡ä»¶ï¼ˆæ¨èï¼‰
å°†æ–‡ä»¶åæ”¹ä¸ºåŒ…å« `æ•…` æˆ– `è³¼` çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š
- `NPM001.jpg` â†’ `æ•…NPM001.jpg`
- `palace_001.jpg` â†’ `æ•…å®«_001.jpg`

### æ–¹å¼äºŒï¼šä¿®æ”¹ä»£ç é€»è¾‘
å¦‚æœéœ€è¦è‡ªå®šä¹‰è¯†åˆ«è§„åˆ™ï¼Œå¯ä»¥ä¿®æ”¹ `app.py` ä¸­çš„ `normalize_image_path()` å‡½æ•°ã€‚

---

## ğŸ“Œ é‡è¦æç¤º

1. **ç›®å½•å¿…é¡»å­˜åœ¨**ï¼šç¡®ä¿ `static/images/palace_images/` ç›®å½•å·²åˆ›å»º
2. **æ–‡ä»¶åç‰¹å¾**ï¼šæ–‡ä»¶åæœ€å¥½åŒ…å« `æ•…` æˆ– `è³¼` ä»¥ä¾¿è‡ªåŠ¨è¯†åˆ«
3. **è·¯å¾„æ ¼å¼**ï¼šåœ¨Excelä¸­å¡«å†™æ—¶ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–æ–‡ä»¶åå³å¯
4. **æ–‡ä»¶æƒé™**ï¼šç¡®ä¿WebæœåŠ¡å™¨æœ‰è¯»å–è¯¥ç›®å½•çš„æƒé™
5. **å›¾åƒæ ¼å¼**ï¼šæ”¯æŒå¸¸è§æ ¼å¼ï¼ˆjpg, jpeg, png, gifç­‰ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **åˆ›å»ºç›®å½•**
   ```powershell
   mkdir static\images\palace_images
   ```

2. **å¤åˆ¶å›¾åƒæ–‡ä»¶**
   å°†NPMåšç‰©é¦†çš„å›¾åƒæ–‡ä»¶å¤åˆ¶åˆ° `static/images/palace_images/` ç›®å½•

3. **å‡†å¤‡Excelå¯¼å…¥æ–‡ä»¶**
   åœ¨ `æœ¬åœ°å›¾ç‰‡è·¯å¾„` åˆ—å¡«å†™æ–‡ä»¶åæˆ–ç›¸å¯¹è·¯å¾„

4. **è¿è¡Œå¯¼å…¥è„šæœ¬**
   ```powershell
   python database_npm/data_importer_multi_table.py
   ```

5. **éªŒè¯**
   å¯åŠ¨åº”ç”¨åï¼Œæ£€æŸ¥å›¾åƒæ˜¯å¦èƒ½æ­£å¸¸æ˜¾ç¤º

